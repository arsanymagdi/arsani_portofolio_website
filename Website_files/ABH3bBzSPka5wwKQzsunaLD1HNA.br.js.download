var TouchFiltercontrol;(function(n){function tt(){return n.tfilErrorMsg}function it(t){n.tfilErrorMsg=t}function c(){return n.tfils||(n.tfils=[]),n.tfils}function rt(){n.tfils=[]}function ut(n){n&&!ft(n)&&Lib.CssClass.add(n,"tfil-disable")}function ft(n){return n&&Lib.CssClass.contains(n,"tfil-disable")}function et(n){n&&Lib.CssClass.remove(n,"tfil-disable")}function a(n){n&&r(n)&&Lib.CssClass.remove(n,"tfil-hide")}function r(n){return n&&Lib.CssClass.contains(n,"tfil-hide")}function v(n){n&&!Lib.CssClass.contains(n,"tfil-navhide")&&Lib.CssClass.add(n,"tfil-navhide")}function y(n){n&&Lib.CssClass.remove(n,"tfil-navhide")}function ot(n){return Lib.CssClass.contains(n,"tfil-active")}function f(n){return t(n,"appns")}function e(n){return t(n,"k")}function t(n,t,i){if(i===void 0&&(i=null),!n)return null;var r="data-"+t;return i===null?n.getAttribute(r):(n.setAttribute(r,i),i)}function i(n,i){return i===void 0&&(i=null),i===null?parseInt(t(n,s),10):(t(n,s,i.toString()),i)}function p(n){return t(n,k)?!0:!1}function st(n){return t(n,o)?!0:!1}function ht(n){var i=n.getElementsByTagName("script"),t,r;if(i)for(t=0;t<i.length;t++)r=i[t],ct(r)}function ct(n){if(n){var t=sj_ce("script","");t.type="text/javascript";n.src?t.src=n.src:t.innerHTML=n.innerHTML;lt(t)}}function lt(n){_d.head.appendChild(n)}function w(n){var t=Math.abs(n);return t>400?5:t<=100?1:Math.ceil(t/100)}function vt(n,t,i,r,u,f,e){var o=function(n,t,i,r,u,f,e){var o=c();(sj_evt.bind("ajax.unload",rt),o[n])||(it(t),o[n]=new l(n,i,r,u,f,e))};typeof SmartRendering!="undefined"?SmartRendering.LoadElementWhenDisplayed(this,_ge(n),o,[n,t,i,r,u,f,e]):o.apply(this,[n,t,i,r,u,f,e])}function yt(n){var t=c();for(var i in t)if(i.indexOf(n)===0)return t[i]}function pt(n,t){var i=yt(n);i&&i.swipeOnHeader(t)}var u="dataurl",b="nc",k="nr",o="al",d=10,s="tfilIndexName",g="tfil-ajaxCompleted",nt="tfil-ajaxError",h=function(){return _w.IsSearchAppXYFocusEnabled?!0:!1},l;typeof String.prototype.trim!="function"&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});l=function(){function n(n,t,u,f,e,o){var s,y,k,c,p,g,l,w,nt,tt,v,b,it;if((this.id=n,this.rtl=t,this.horizontalSwipeThreshold=u,this.enableBleeding=f,this.isMultiGroup=e,this.baseUrl=o,this.kVal="",s=this,y=_ge(n),y)&&(s.container=y,s.head=s.container.firstElementChild,s.content=s.container.lastElementChild,f&&(s.content=s.container.lastChild.firstChild),k=Array.prototype.slice.call(s.head.getElementsByClassName("tfil-menu")),s.menuContainers=k.map(function(n){return n}),s.menus=s.menuContainers.map(function(n){return n.firstElementChild}),s.menuContainer=s.menuContainers[0],s.menu=s.menus[0],s.actives=[],s.styles=s.menuContainers.map(function(n){return n.appendChild(_d.createElement("style")),n.lastElementChild}),s.offsets=Array(s.menus.length),s.header=_ge("b_header"),s.menuTotalHeight=s.menuContainer.clientHeight+d,c=s.menu,c)){for(p=0,g=function(n){for(var r=function(){var r=n.children[t];ot(r)&&(s.active=r,s.actives.push(r));i(r,t);s.bind(r);sj_be(r,"keydown",function(t){var i,u;t.keyCode===13?(s.click(r),r.focus()):t.keyCode===36?(t.preventDefault(),i=n.children[0],s.click(i),i.focus()):t.keyCode===35&&(t.preventDefault(),u=n.children[n.childElementCount-1],s.click(u),u.focus());h()&&(t.keyCode===37||t.keyCode===39)&&t.preventDefault()})},t=0;t<n.children.length;++t)r();sj_be(n.children[0],"transitionend",function(n){return s.onScrollEnd(n.target.parentElement)});s.enableDrag(n);s.offsets[p]=0;i(n,p++)},l=0,w=s.menus;l<w.length;l++)nt=w[l],g(nt);if(s.navLeft=_ge(n+"_navl_0"),s.navRight=_ge(n+"_navr_0"),tt=parseInt(_w.getComputedStyle(s.menu.firstElementChild,null).getPropertyValue("margin-right")),!e&&r(s.navLeft)&&c.scrollWidth-tt>c.offsetWidth&&(a(s.navLeft),a(s.navRight),Lib.CssClass.add(s.menuContainer,"tfil-hasnav")),r(s.navLeft)||(sj_be(s.navLeft,"click",function(){var n=s.findClosestItemLeft(s.rtl?s.menu.scrollLeft+s.menu.offsetWidth:s.menu.scrollLeft),t=s.rtl?n.left-s.menu.scrollLeft-1:n.left+n.width-s.menu.offsetWidth-s.menu.scrollLeft+1;s.shift(t)}),sj_be(s.navRight,"click",function(){var n=s.findClosestItemLeft(s.rtl?s.menu.scrollLeft:s.menu.scrollLeft+s.menu.offsetWidth),t=s.rtl?n.left+n.width-s.menu.offsetWidth-s.menu.scrollLeft+1:n.left-s.menu.scrollLeft-1;s.shift(t)})),typeof Orientation!="undefined"&&Orientation&&Orientation.onOrientation)Orientation.onOrientation(function(n){Log.Log("Rotate","TouchFilter",n?"LS":"PT",!1)});for(sj_evt.bind("tfil_reload",function(n){n[1]===s.id&&s.loadAjaxData(s.active)}),s.navstate(),v=0,b=s.menus;v<b.length;v++)it=b[v],s.captureAllTocuhEvents(it);s.SetKVal();sj_evt.fire("tfil_init_finished")}}return n.prototype.SetKVal=function(){this.kVal=f(this.content)+"."+e(this.content)},n.prototype.captureAllTocuhEvents=function(n){["touchstart","touchmove","touchend","touchout"].forEach(function(t){sj_be(n,t,function(n){sj_sp(n)})})},n.prototype.nav=function(n){n===void 0&&(n=!1);var t=this,i=n===t.rtl?t.active.nextSibling:t.active.previousSibling;return i?(t.click(i),i.focus(),!0):(Log.Log(n?"Next":"Prev","TouchFilter","Nav",!1),!1)},n.prototype.headerOnMove=function(n){var t=this,i=t.menu.scrollLeft+n;t.shift(i,!0)},n.prototype.bind=function(n){var t=this;sj_be(n,"click",function(i){t.click(n);n.focus();Log.Log("Select","Tab","TouchFilter",!1,"AppNS",f(n),"K",e(n));Swipe.StopEffect(i)})},n.prototype.click=function(n){var r=this,t=r.actives[i(n.parentElement)];!n||t===n||n.classList.contains("tfil-subc")||n.classList.contains("tt-tfil-seperator")||(t&&this.deactivate(t),this.activate(n),t&&t.removeAttribute&&t.removeAttribute("tabIndex"),n.tabIndex=0,r.select(n))},n.prototype.activate=function(n){Lib.CssClass.add(n,"tfil-active");sj_evt.fire("tfilactive",this.id,i(n));n.setAttribute("aria-selected","true");Log.Log("Show","Tab","TouchFilter",!1,"AppNS",f(n),"K",e(n))},n.prototype.deactivate=function(n){Lib.CssClass.remove(n,"tfil-active");sj_evt.fire("tfildeactive",this.id,i(n));n.setAttribute("aria-selected","false")},n.prototype.select=function(n){var t=this;t.actives[i(n.parentElement)]=n;p(n)&&st(n)||t.loadAjaxData(n);h()&&n.focus()},n.prototype.navstate=function(){var n=this;et(n.navRight);(n.rtl?-1*Math.floor(n.menu.scrollLeft)>=n.menu.scrollWidth-n.menu.offsetWidth:Math.ceil(n.menu.scrollLeft)>=n.menu.scrollWidth-n.menu.offsetWidth)&&ut(n.navRight)},n.prototype.navHideState=function(n){this.isMultiGroup&&r(this.navLeft)||(n?y(this.navLeft):n||v(this.navLeft))},n.prototype.navHideStateForDragging=function(n){if(this.navLeft&&this.navRight&&(!this.isMultiGroup||!r(this.navLeft))){var t=this.navRight.offsetWidth,i=Math.abs(n)>t,u=this.navLeft&&Lib.CssClass.contains(this.navLeft,"tfil-navhide");i||u?i&&u&&(this.menu.scrollLeft+=this.rtl?-t:t,y(this.navLeft)):(this.menu.scrollLeft+=this.rtl?t:-t,v(this.navLeft))}},n.prototype.findClosestItemLeft=function(n){var u=this.menu.children,o=this.rtl?this.menu.lastChild:this.menu.firstChild,l=this.rtl?this.menu.firstChild:this.menu.lastChild,s=o.offsetLeft,c=l.offsetLeft-s,f=parseInt(window.getComputedStyle(o).marginLeft),r={left:this.rtl?f:0,width:o.offsetWidth-(this.rtl?0:f)},h;if(n>=c)return r.left=c+(this.rtl?f:0),r;if(n<=0||u.length<=1)return r;for(var i=0,e=u.length-1,t=0;i<e;)t=(i+e)/2,t=this.rtl?Math.floor(t):Math.ceil(t),h=u[t].offsetLeft-s,h>n?this.rtl?i=t+1:e=t-1:h==n?i=e=t:this.rtl?e=t:i=t;return r.left=u[i].offsetLeft-s+(this.rtl?f:0),r.width=u[i].offsetWidth-(this.rtl?0:f),r},n.prototype.shiftToItem=function(n){var r=this,t=n.parentElement,i,u;t.scrollWidth<=t.offsetWidth||(i=n.offsetLeft-t.offsetWidth/2+n.offsetWidth/2,i-=r.rtl?t.lastChild.offsetLeft:t.firstChild.offsetLeft,u=i-t.scrollLeft,r.shift(u,!1,t))},n.prototype.shift=function(n,t,r){var s,h,c;t===void 0&&(t=!1);r===void 0&&(r=this.menu);var u=this,l=u.styles[i(r)],f=r.scrollLeft,e=r.scrollWidth-r.offsetWidth,o=n+f;if(t){r.scrollLeft+=n;u.navHideState(u.rtl?Math.ceil(f)<e:f>0);u.navstate();return}Lib.CssClass.contains(r,"moving")||(s=!1,h=!1,(u.rtl?o>=0:o<=0)?(n=-f,s=!0):(u.rtl?-1*Math.floor(o)>=e:Math.ceil(o)>=e)&&(n=u.rtl?-(e+f):e-f,h=!0),c=!s,u.navHideState(c),Math.abs(n)<=0)||(u.offsets[i(r)]=n,l.innerHTML="#".concat(r.id,".moving .tfil-filter{transform:translateX(").concat(-1*n,"px);}"),Lib.CssClass.add(r,"moving"),Lib.CssClass.add(r,"sp_"+w(n)))},n.prototype.onScrollEnd=function(n){var t=this.offsets[i(n)];Lib.CssClass.remove(n,"moving");Lib.CssClass.remove(n,"sp_"+w(t));n.scrollLeft+=t;this.navstate()},n.prototype.enableDrag=function(n){var t=this,i,r,u=!0,f=function(n){(Math.abs(n.pageX-i)>5||Math.abs(n.pageY-r)>5)&&(n.preventDefault&&n.preventDefault(),n.stopPropagation&&n.stopPropagation())},e=function(o){i=o.pageX;r=o.pageY;u&&(n.scrollWidth<=n.offsetWidth&&(sj_ue(_w,"mousedown",e,!0),sj_ue(_w,"click",f,!0)),u=!1);o.preventDefault&&o.preventDefault();var s=o.pageX,h=function(i){var r=i.pageX-s;n.scrollLeft-=r;s=i.pageX;t.navHideStateForDragging(t.rtl?Math.ceil(n.scrollLeft)-(n.scrollWidth-n.offsetWidth):n.scrollLeft)},c=function(){t.navstate();sj_ue(_w,"mousemove",h,!0);sj_ue(_w,"mouseup",c,!0)};sj_be(_w,"mousemove",h,!0);sj_be(_w,"mouseup",c,!0)};sj_be(n,"mousedown",e,!0);sj_be(n,"click",f,!0)},n.prototype.getUrlForMultigroup=function(){for(var f,r=this.baseUrl,i="",n=0;n<this.actives.length;++n)f=t(this.actives[n],u),i+=f,n<this.actives.length-1&&(i+="&");return r+((r.indexOf("?")!=-1?"&":"?")+i)},n.prototype.loadAjaxData=function(n){var e=this,r="",o,s,f;if(this.isMultiGroup)r=e.getUrlForMultigroup();else if(r=t(n,u),o=t(n.parentNode,u),o&&r[0]==="#")for(s=r.substr(1).split("#"),r=o,f=0;f<s.length;++f)r=r.replace(new RegExp("\\{"+f+"\\}","gm"),s[f]);this.loadAjaxDataHelper(n,r,function(t){sj_evt.fire("layoutChange",e.id,i(n));t&&sj_evt.fire("touchFilter_ajaxLoaded",e.id,i(n));sj_evt.fire(RichTranslateHelper.loadMobileFilterData)})},n.prototype.loadAjaxDataHelper=function(n,i,r){var e,f,u;r===void 0&&(r=null);i&&(e=this.content.className+"_dynamic_"+this.id,f=sj_ce("div",e,"b_tfil-ajaxLoad"),this.content.innerHTML="",this.content.appendChild(f),u=sj_gx(),i+=(i.indexOf("?")!=-1?"&":"?")+"IID="+this.kVal+"&IG="+_G.IG,u.open("GET",i,!0),sb_st(function(){u&&u.abort()},1e4),u.onreadystatechange=function(){var i;if(u!==null&&4===u.readyState){var s=u.status,e=u.responseText,h=!u.getAllResponseHeaders();if(u=null,i=200===s&&e!==null&&e!=="",f.className=i?g:nt,f.innerHTML=i?e:tt(),i){p(n)&&t(n,o,"1");i=!1;try{e&&(ht(f),_w.rms&&_w.rms.start(),i=!0)}catch(c){Log.Log("Error","TouchFilter","ScriptException",!1,"Tx",c.message)}}else Log.Log("Error","TouchFilter",h?"Timeout":""+s,!1);r&&r(i)}},u.send())},n.prototype.swipeOnHeader=function(n){this.headerOnMove(n)},n.prototype.selectTouchFilter=function(n){var t=this.menu.children[n];t&&this.click(t)},n}();n.init=vt;n.swipeTouchFilterHeader=pt;typeof WireUp!="undefined"&&WireUp&&WireUp.init("tfil",function(n){if(n){var t=n.id;WireUp.onUpdate(n,"a",function(){sj_evt.fire("tfil_reload",t)})}});sj_evt.fire("tfil_init",n)})(TouchFiltercontrol||(TouchFiltercontrol={}))